---
tags:
  - подключение
  - подключения
  - AD
  - Active Directory
hide:
  - tags
---

# Хранилище S3. Настройка экземпляра ПО и подключения

## Введение

ПО **Comindware Business Application Platform** может хранить загруженные пользователями и сформированные системой файлы в хранилище S3:

- файлы, прикреплённые к атрибутам типа «Документ» и «Изображение»;
- файлы, загруженные на странице «Темы»;
- файлы шаблонов экспорта;
- файлы с исходным кодом адаптеров;
- резервные копии экземпляра ПО;
- загруженные файлы изображений для баннеров;
- изображения профилей аккаунтов;
- загруженные изображения фона страниц входа и регистрации;
- временные файлы экземпляра ПО.

В данной статье представлены инструкции по настройке конфигурации экземпляра ПО под управлением Linux для подключения к хранилищу S3 с целью хранения файлов в контейнерах (корзинах) S3.

После настройки экземпляра ПО и подключения к хранилищу S3 файлы, загруженные пользователями и сформированные системой будут отправляться в хранилище S3, а в конфигурации резервного копирования можно будет указать контейнер S3 вместо пути на сервере с экземпляром ПО.

## Настройка конфигурации экземпляра ПО

1. Перейдите в режим суперпользователя:
    
    ```
    sudo -i
    ```
    
2. Откройте для редактирования файл конфигурации экземпляра ПО:
    
    ```
    vim /usr/share/comindware/configs/instance/instancename.yml
    ```
    
    Здесь  `_**instancename**_` — имя экземпляра ПО.  
    См. также статью _«[Пути и содержимое папок экземпляра ПО](https://kb.comindware.ru/article/%d0%9f%d1%83%d1%82%d0%b8-%d0%b8-%d1%81%d0%be%d0%b4%d0%b5%d1%80%d0%b6%d0%b8%d0%bc%d0%be%d0%b5-%d0%bf%d0%b0%d0%bf%d0%be%d0%ba-%d1%8d%d0%ba%d0%b7%d0%b5%d0%bc%d0%bf%d0%bb%d1%8f%d1%80%d0%b0-%d0%9f%d0%9e-2502.html)»._
3.  Добавьте в файл `_**instancename**_.yml` следующие директивы:
    
    ```
    # Адрес сервера S3 с указанием порта, идентификатор ключа доступа и секретный ключ
    ```
    
    Внимание!
    
    - Необходимо указать разные контейнеры (корзины) для загруженных файлов и для временных файлов.
    - Имена корзин не должны содержать прописных (заглавных) букв.
    
4. Перезагрузите экземпляр ПО:
    
    ```
    systemctl restart comindwareinstancename
    ```
    
5. Проверьте подключение хранилищу S3 в экземпляре ПО.

## Проверка подключения к хранилищу S3

1. Перейдите в [список подключений](https://kb.comindware.ru/article.php?id=2205#mcetoc_1gjrlqi4l1).
2. Дважды нажмите в списке подключение типа «**S3**» (название подключения задаётся директивой `s3Connection.default.description` в [файле конфигурации](https://kb.comindware.ru/article.php?id=2594#mcetoc_1gjrlqj8j2)).
3. Просмотрите свойства подключения:  
    - **Отключить** — этот флажок установлен, если подключение неактивно;
    - **Название** — наглядное наименование подключения;
    - **Адрес конечной точки** — адрес сервера S3;
    - **Ключ доступа** — идентификатор секретного ключа доступа к серверу S3;
    - **Секретный ключ** — ключ для доступа к серверу S3;
    - **Запросы типа path-style** — флажок установлен, если сервер принимает только запросы path-style вида:
        
        ```
        https://s3.region-code.amazonaws.com/bucket-name/key-name
        ```
        
4. Нажмите кнопку «**Проверить соединение**».
    - Должно отобразиться сообщение «**Соединение установлено**».

!!! warning "Внимание!"
    Не вносите изменения в окне свойств подключения к хранилищу S3, заданному в [файле конфигурации](https://kb.comindware.ru/article.php?id=2594#mcetoc_1gjrlqj8j2) экземпляра ПО (`/usr/share/comindware/configs/instance/_**instancename**_.yml`) с помощью директивы `s3Connection.default`. Они не будут применены к конфигурации экземпляра ПО и при перезапуске сервера будут заменены на значения из файла конфигурации `_**instancename**_.yml`

Настраивать подключение к хранилищу S3 следует только в файле `/usr/share/comindware/configs/instance/_**instancename**_.yml`

*![Настройка подключения к хранилищу S3](https://kb.comindware.ru/assets/img_65e9b87a6e895.png)*
## Связанные статьи

**[Пути и содержимое папок экземпляра ПО]({{kbArticleURLPrefix}}2502)**